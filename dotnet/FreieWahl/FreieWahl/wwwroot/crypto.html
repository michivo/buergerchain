<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="js/jsbn.js"></script>
    <script src="js/jsbn2.js"></script>
    <script src="js/sha256.js"></script>
    <script src="js/secure-random.js"></script>
    <script src="js/blinding.js"></script>
    <script src="lib/jquery/dist/jquery.js"></script>
    <script>
        function blindData() {
            var message = document.getElementById('txtVal').value;
            var n = new BigInteger(
                "108182674951968852666449405909438166109771964094185953581483749473135671444735956446128426451389437838293182571403114948625203599342302391397220297359451226860449558602359497253344604069561763332009206777668589464067817524572438777182040635407307000695208057481048088804554425507797641731051027032035412027473");
            var e = new BigInteger('65537');
            var blinded = blind(messageToHashInt(message), n, e);
            var blinded2 = blind(blinded.blinded, n, e);
            $('#blinded').html(blinded2.blinded.toString());
            $('#randVal').html(blinded.r.toString());
            $('#randVal2').html(blinded2.r.toString());
        }

        function unblindData() {
            var message = document.getElementById('signed').value;
            var r = $('#randVal').html();
            var r2 = $('#randVal2').html();
            var n = new BigInteger(
                "108182674951968852666449405909438166109771964094185953581483749473135671444735956446128426451389437838293182571403114948625203599342302391397220297359451226860449558602359497253344604069561763332009206777668589464067817524572438777182040635407307000695208057481048088804554425507797641731051027032035412027473");
            var unblidedData = unblind(new BigInteger(message), new BigInteger(r2), n);
            unblidedData = unblind(unblidedData, new BigInteger(r), n);
            $('#unblinded').html(unblidedData.toString());
        }
    </script>
</head>
<body>
<input type="text" id="txtVal" value="hello world!">
<input type="text" id="signed" value="hello world!">
<button onclick="blindData()">Blind</button>
<button onclick="unblindData()">Unblind</button>
<div id="blinded">---</div>
<div id="randVal">---</div>
<div id="randVal2">---</div>
<div id="unblinded">---</div>
</body>
</html>