function isEmpty(n){return!n||0===n.length||n==="0"}function formatDateTimeSeconds(n){var t=new Date(0);return t.setUTCSeconds(n),`${t.getDate()}.${(t.getMonth()+1).toString().padStart(2,"0")}.${t.getFullYear()} ${t.getHours()}:${t.getMinutes().toString().padStart(2,"0")}`}function formatDateTimeSecondsForMail(n){var t=new Date(0);return t.setUTCSeconds(n),`${t.getDate()}.${t.getMonth()+1}.${t.getFullYear()} um ${t.getHours()}:${t.getMinutes().toString().padStart(2,"0")}`}function truncate(n,t){return n.length<t?n:n.substr(0,t)+"..."}function blinkOnScroll(){const n=$(window).height()*1.1,t=$(window).scrollTop();$(".blinkOnScroll:not(.animated)").each(function(){var i=$(this),r=i.offset().top;t+n>r&&(i.data("timeout")?window.setTimeout(function(){i.addClass("animated blinky")},parseInt(i.data("timeout"),10)):i.addClass("animated blinky"))});$(".blinkOnScroll.animated").each(function(){const i=$(this),r=i.offset().top;t+n<r&&$(this).removeClass("animated blinky")})}function lazyLoad(n,t){const r=`.search-script-${t}`;let u=document.querySelectorAll(r);if(!(u.length>0)){let i=document.createElement("script");i.src=n;i.className=r;document.body.appendChild(i)}}function setupOverview(){initApp();$("document").ready(function(){$("#fw-user-img-input").change(function(){previewAndUploadFile("user")});$("#fw-voting-img-input").change(function(){previewAndUploadFile("voting")});$("#fwStartDate").change(function(){fwValidate("#fwStartDate","#fwStartDateValidation",/^[0-3]?\d\.[0,1]?\d\.20\d{2}$/)});$("#fwEndDate").change(function(){fwValidate("#fwEndDate","#fwEndDateValidation",/^[0-3]?\d\.[0,1]?\d\.20\d{2}$/)});$("#fwStartTime").change(function(){fwValidate("#fwStartTime","#fwStartTimeValidation",/^[0-2]?\d:[0-5]\d$/)});$("#fwEndTime").change(function(){fwValidate("#fwEndTime","#fwEndTimeValidation",/^[0-2]?\d:[0-5]\d$/)});$("#fwNewVotingName").change(function(){fwValidate("#fwNewVotingName","#fwNewVotingNameValidation",/^(?!\s*$).+/)});showOverview();$("#fw-user-img-content").hover(function(){highlightImgSelector("user","rgba(255, 255, 255, 0.5)")},function(){resetImgSelector("user","rgba(255, 255, 255, 0.5)")});$("#fw-voting-img-content").hover(function(){highlightImgSelector("voting","rgba(101, 127, 140, 0.5)")},function(){resetImgSelector("voting","rgba(101, 127, 140, 0.5)")});$(".form-group.date").datepicker({format:"dd.mm.yyyy",autoclose:!0,language:"de",orientation:"top left"})})}function highlightImgSelector(n,t){$("#fw-"+n+"-img-selector").css("border","1px solid "+t);$("#fw-"+n+"-img-selector").css({backgroundColor:"rgba(0,0,0,.5)"});$("#fw-"+n+"-img-selector").css("box-shadow","1px 1px 1px rgba(0, 0, 0, 0.5)");$("#fw-"+n+"-img-icon").animate({fontSize:"1.5rem",color:"white"});$("#fw-"+n+"-img-text").animate({opacity:1})}function resetImgSelector(n,t){$("#fw-"+n+"-img-selector").css("border","0px solid "+t);$("#fw-"+n+"-img-selector").css({backgroundColor:"rgba(0,0,0,0)"});$("#fw-"+n+"-img-icon").animate({fontSize:"2rem"});$("#fw-"+n+"-img-text").animate({opacity:0});$("#fw-"+n+"-img-selector").css("box-shadow","0px 0px 0px");$("#fw-"+n+"-img-upload").css("display","none")}function showFileSelector(n){$(n).css("display","inline")}function highlightAddVoting(n){$(n).addClass("shadow-pulse")}function resetAddVoting(n){$(n).removeClass("shadow-pulse")}function createVoting(){$("#newVotingModal").modal()}function previewAndUploadFile(n){var r=$("#fw-"+n+"-img-input")[0].files[0],t,i;r.type.match(/image.*/)&&(t=new Image,i=new FileReader,i.onload=function(n){t.src=n.target.result},t.onload=function(){var u=document.getElementById("fw-"+n+"-img-real"),o=u.getContext("2d"),f=300,e=300,i=t.width,r=t.height;i>r?i>f&&(r*=f/i,i=f):r>e&&(i*=e/r,r=e);u.width=i;u.height=r;o.drawImage(t,0,0,i,r);$("#fw-"+n+"-img-dummy").hide();$("#fw-"+n+"-img").hide();$("#fw-"+n+"-img-real").show();n==="user"&&uploadFile()},i.readAsDataURL(r))}function uploadFile(){var n=document.getElementById("fw-user-img-real"),t=n.toDataURL();$.ajax({url:"UpdateUserImage",type:"POST",data:{imageData:t},success:updateImage,error:function(){}})}function updateImage(){$("#fw-"+type+"-img").show();$("#fw-"+type+"-img-real").hide()}function fwValidate(n,t,i){const r=$(n).val();return r.match(i)?($(n).removeClass("is-invalid"),$(t).removeClass("d-block"),!0):($(n).addClass("is-invalid"),$(t).addClass("d-block"),!1)}function saveVoting(){var r=$("#fwNewVotingName").val(),u=$("#fwNewVotingDescription").val(),t="",n=fwValidate("#fwStartDate","#fwStartDateValidation",/^[0-3]?\d\.[0,1]?\d\.20\d{2}$/),i;if(n=fwValidate("#fwEndDate","#fwEndDateValidation",/^[0-3]?\d\.[0,1]?\d\.20\d{2}$/)&&n,n=fwValidate("#fwStartTime","#fwStartTimeValidation",/^[0-2]?\d:[0-5]\d$/)&&n,n=fwValidate("#fwEndTime","#fwEndTimeValidation",/^[0-2]?\d:[0-5]\d$/)&&n,n=fwValidate("#fwNewVotingName","#fwNewVotingNameValidation",/^(?!\s*$).+/)&&n,n){$("#fw-voting-img-real").is(":visible")&&(i=document.getElementById("fw-voting-img-real"),t=i.toDataURL());const f=parseDateTime($("#fwStartDate").val(),$("#fwStartTime").val()),e=parseDateTime($("#fwEndDate").val(),$("#fwEndTime").val());$.post({url:"UpdateVoting",data:{title:r,desc:u,id:null,imageData:t,startDate:f.toISOString(),endDate:e.toISOString()},success:function(n){$("#newVotingModal").modal("hide");window.location.replace(`Edit?id=${n}&isNew=true`)},error:function(n){alert(n)}})}}function parseDateTime(n,t){const i=n.split("."),r=t.split(":"),u=parseInt(i[0]),f=parseInt(i[1]),e=parseInt(i[2]),o=parseInt(r[0]),s=parseInt(r[1]);return new Date(e,f-1,u,o,s)}function showOverview(){$(".fw-open-voting").remove();$("#fw-load-votings-card").show();$.ajax({url:"GetVotingsForUser",type:"GET",datatype:"json",success:showOverviewData,error:function(n){console.log("oops, error");$("<div/>",{"class":"bc-error-message TODO TODO error handling",html:"An error occurred getting your votings: "+n}).appendTo("#votingOverviewListContent");componentHandler.upgradeDom();$("#fw-load-votings-card").hide()}})}function showOverviewData(n){var i=[],t;for($("#fw-active-voting-count").text(n.length),t=0;t<n.length;t++){const r=n[t];let u='<div class="col-xl-4 col-md-6 col-12 fw-open-voting"><div class="card fw-overview-card">'+`<a href="Edit?id=${r.id}">`;u+=r.imageData?`<img class="card-img-top" style="max-height:12rem;" src="${r.imageData}">`:'<i class="material-icons fw-voting-img" style="text-align:center;width:100%">how_to_vote<\/i>';u+=`</a><div class="card-body d-flex flex-column justify-content-between" style="height:12rem"><h5 class="card-title">${r.title}</h5>`+`<p class="card-text">${truncate(r.description,50)}</p>
`+`<div><a class="fw-card-link-icon float-left p-2 border" href="javascript:void(0);" onclick="deleteVoting('${r.id}')"><i class="material-icons">delete</i></a>
`+`<a class="fw-card-link-icon bg-primary float-right p-2" href="Edit?id=${r.id}"><i class="material-icons text-white">edit</i></a></div></div></div></div>`;i.push(u)}$(i.join("\n")).insertAfter("#fw-new-voting-onboarding");$("#fw-load-votings-card").hide();n.length===0?($("#fw-new-voting-onboarding").removeClass("d-none").addClass("d-flex"),$("#fw-new-voting-button").addClass("d-none")):($("#fw-new-voting-onboarding").removeClass("d-flex").addClass("d-none"),$("#fw-new-voting-button").removeClass("d-none"));componentHandler.upgradeDom();$(".fw-overview-card").mouseover(function(){$(this).removeClass("fw-overview-card-inactive");$(this).addClass("fw-overview-card-active")});$(".fw-overview-card").mouseout(function(){$(this).removeClass("fw-overview-card-active");$(this).addClass("fw-overview-card-inactive")})}function deleteVoting(n){confirm("Sind Sie sicher, dass Sie diese Abstimmung unwiderruflich l√∂schen wollen?")&&$.post({url:"DeleteVoting",data:{id:n},success:function(){showOverview(firebase.auth().currentUser)}})}